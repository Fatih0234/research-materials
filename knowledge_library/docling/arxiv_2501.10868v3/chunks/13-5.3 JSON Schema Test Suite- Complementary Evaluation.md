## 5.3 JSON Schema Test Suite: Complementary Evaluation

Originally designed to test the correctness and compliance of JSON Schema validation implementations, the official JSON Schema Test Suite [JSON Schema Org, 2024] is a comprehensive collection of test cases spanning the many features of the JSON Schema specification. We believe that the test suite is an ideal tool for assessing the correctness of grammar engines.

The test suite organizes its test cases into 45 categories, each of which corresponds to a feature of JSON Schema, typically a specific keyword such as required or group of tightly related keywords such as if-then-else . A small number of additional categories test broader behaviors, such as infinite-loop-detection . Each test case contains a single schema paired with a collection of JSON instances that are marked as either valid or invalid under that schema. For the purpose of evaluating coverage, we assert that an engine must successfully generate each valid instance and block generation of each invalid instance to 'pass' a test case. In addition to compilation failures, we define two failure modes that a grammar engine can exhibit:

Definition 5.4 (Over-constrained) A framework is over-constrained if it rejects JSON instances that are valid according to a given JSON Schema. This means the engine is too strict and excludes outputs that should be allowed.

Definition 5.5 (Under-constrained) A framework is under-constrained if it allows JSON instances that are invalid according to a given JSON Schema. This means the engine is overly permissive and allows outputs that should be rejected.

An illustration is given in Figure 5 in Appendix D. Over-constrained grammar engines risk limiting the expressive power of LMs, potentially preventing the generation of valid responses and negatively impacting downstream task performance. Conversely, under-constrained engines cannot guarantee that all responses will be valid, often necessitating additional post-processing or retry logic.

6 The Llama 3.1 models have been specifically fine-tuned to adhere to JSON schemas [Grattafiori et al., 2024]

Table 4: Coverage of all the frameworks on JSONSchemaBench. Empirical coverage between Open Source engines and OpenAI/Gemini are not directly comparable due to differences in the underlying model (Llama 3.2-1B vs. proprietary models).

∗ Gemini results are ommitted for dataset suites with &lt; 1% support.

| Dataset           | Framework         | Declared   | Empirical   | Compliance Rate   |
|-------------------|-------------------|------------|-------------|-------------------|
| GlaiveAI          | LM only           | 1.00       | 0.90        | 0.90              |
|                   | Guidance          | 0.98       | 0.96        | 0.98              |
|                   | Llamacpp          | 0.98       | 0.95        | 0.97              |
|                   | Outlines          | 0.99       | 0.95        | 0.96              |
|                   | XGrammar          | 1.00       | 0.93        | 0.93              |
|                   | OpenAI            | 0.89       | 0.89        | 1.00              |
|                   | Gemini            | 0.86       | 0.86        | 1.00              |
| GitHub Easy       | LM only           | 1.00       | 0.65        | 0.65              |
|                   | Guidance          | 0.90       | 0.86        | 0.96              |
|                   | Llamacpp          | 0.85       | 0.75        | 0.88              |
|                   | Outlines          | 0.86       | 0.59        | 0.83              |
|                   | XGrammar          | 0.91       | 0.79        | 0.87              |
|                   | OpenAI            | 0.30       | 0.29        | 0.97              |
|                   | Gemini            | 0.08       | 0.07        | 0.88              |
| Snowplow ∗        | LM only           | 1.00       | 0.46        | 0.46              |
|                   | Guidance          | 0.87       | 0.82        | 0.94              |
|                   | Llamacpp          | 0.92       | 0.74        | 0.81              |
|                   | Outlines          | 0.95       | 0.36        | 0.61              |
|                   | XGrammar          | NA         | NA          | NA                |
|                   | OpenAI            | 0.21       | 0.21        | 1.00 0.38         |
| GitHub Medium ∗   | LM only           | 1.00 0.79  | 0.38 0.69   | 0.87              |
|                   | Guidance Llamacpp | 0.77       | 0.57        | 0.74              |
|                   | Outlines          | 0.72       | 0.29        | 0.40              |
|                   | XGrammar          | 0.79       | 0.52        | 0.66              |
|                   | OpenAI            | 0.13       | 0.12        | 0.92              |
| Kubernetes ∗      | LM only           | 1.00       | 0.56        | 0.56              |
|                   | Guidance          | 0.98       | 0.91        | 0.92              |
|                   | Llamacpp          | 0.98       | 0.76        | 0.78              |
|                   | Outlines          | 0.98       | 0.57        | 0.58              |
|                   | XGrammar          | 0.12       | 0.07        | 0.58              |
|                   | OpenAI            | 0.21       | 0.21        | 1.00              |
| Washington Post ∗ | LM only           | 1.00       | 0.40        | 0.40              |
|                   | Guidance          | 0.86       | 0.86        | 1.00              |
|                   | Llamacpp          | 0.97       | 0.94        | 0.97              |
|                   | Outlines          | 0.97       | 0.22        | 0.23              |
|                   | XGrammar          | 0.85       | 0.64        | 0.75              |
|                   | OpenAI            | 0.13       | 0.13        | 1.00              |
| GitHub Hard ∗     | LM only           | 1.00       | 0.13        | 0.13              |
|                   | Guidance          | 0.60       | 0.41        | 0.69              |
|                   | Llamacpp          | 0.61       | 0.39        | 0.63              |
|                   | Outlines          | 0.47       | 0.03        | 0.06              |
|                   | XGrammar          | 0.69       | 0.28        | 0.41              |
|                   |                   | 0.09       | 0.09        | 1.00              |
| ∗                 | OpenAI            | 1.00       | 0.21        | 0.21              |
| JsonSchemaStore   | LM only Guidance  | 0.35       | 0.30        | 0.88              |
|                   | Llamacpp          | 0.54       | 0.38        | 0.69              |
|                   | Outlines XGrammar | 0.38 0.76  | 0.09 0.33   | 0.24 0.43         |
|                   | OpenAI            |            | 0.06        | 1.00              |
|                   |                   | 0.06       |             |                   |
