## A.1 Proofs of Section 4.1.3

Theorem 4.2. [Monotonicity of the optimal allocation] The optimal allocation rule π θ ∗ which maximizes the objective function of the mechanism in Eq. (2) achieves allocation monotonicity. Formally, for any i and fixed ( x, h, a , b -i ) , when b ′ i ≥ b i , the following holds:

<!-- formula-not-decoded -->

Proof. In this section, we prove that optimal policy enjoys monotonic allocation. For ease of notation, in the following we use π θ ( b i ) to represent π θ ( · | x, h, a , ( b i , b -i )) when other parameters ( x, h, a , b -i ) are fixed.

First, according to Definition 3.7, for any bid b from the advertiser i , we have:

<!-- formula-not-decoded -->

Next, based on Eq. (9), we can obtain the following inequalities:

<!-- formula-not-decoded -->

Then, based on Eq. (2), we can expand the above inequalities as follows:

̸

<!-- formula-not-decoded -->

̸

̸

<!-- formula-not-decoded -->

Combining inequalities (10) and (11), we have

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

which completes the proof.

̸

Theorem 4.3. [Continuity of the optimal allocation] In the LLM-native advertising setting, if π θ 0 ( y | x, h, a , b ) is continuous in the bid profile b , then for any fixed ( x, h, a ) with the optimal allocation rule π θ ∗ , for any i , the ITCTR itctr i ( π θ ∗ ( · | x, h, a , b )) is a continuous function of b .

Proof. Given bid profile b , we rewrite our objective function Eq. (2):

<!-- formula-not-decoded -->

where s KL u ( y ) = D KL ( π θ ( y | x, h, a , b ) ∥ π θ 0 ( y | x, h, a , b )) .

Based on Assumption 4.1, our pCTR model is unbiased. Thus, we can use reward model defined in Eq. (5) to represent our objective function in Eq. (2):

<!-- formula-not-decoded -->

According to prior work Rafailov et al. [2023], based on the reward model defined in Eq. (5), the optimal allocation rule π θ ∗ obtained by the DPO algorithm is as follows:

where

<!-- formula-not-decoded -->

Then, we have

<!-- formula-not-decoded -->

Recall that the reward function defined in Eq. (5),

<!-- formula-not-decoded -->

is linear-and hence continuous-in the bid profile b . Under the assumption that π θ 0 ( y | x, h, a , b ) is continuous in the bid profile b ∈ [0 , ¯ b ] n , for each fixed y , the map

<!-- formula-not-decoded -->

is continuous on [0 , ¯ b ] n , as it is the product of two continuous functions. Since ctr i ( x, h, a i , y ) and ✶ { a i ∈ y } do not depend on b , we conclude:

- The numerator of Eq. (13) is a finite sum of continuous functions of b , hence continuous in b .
- The denominator of Eq. (13) is also a finite sum of continuous functions of b , and is strictly positive for all b ∈ [0 , ¯ b ] n , because exp( · ) &gt; 0 and π θ 0 ( · ) is a probability distribution (thus nonnegative and not identically zero).

Therefore, the ratio in Eq. (13) defines a continuous function of b on the compact set [0 , ¯ b ] n .
